<style lang="scss" scoped>
.negotiatedorderdetail {
  .neod {
    border-radius: 5px;
    background: #4b3f91;
    color: white;
    padding: 5px 10px;
  }
  margin-left: 20px;
  .negotiatedorderdetail-title {
    line-height: 40px;
    font-size: 1rem;
    color: #4b3f91;
    font-weight: 600;
    border-bottom: 1px solid #ddd;
  }
  .negotiatedorderdetail-content {
    padding: 10px 20px 0 20px;
    border: 1px solid #ddd;
    margin: 10px 0 0 0;
    .negotiatedorderdetail-content-list2 {
      line-height: 60px;
      display: flex;
      .negotiatedorderdetail-content-list2-p {
        overflow: hidden;
        width: 100%;
        font-size: 1.1rem;
        font-weight: 600;
        color: #4b3f91;
      }
    }
    .negotiatedorderdetail-content-list2-p2 {
      font-size: 0.93rem;
      color: #b9b3b3;
      font-weight: 500;
    }
    .negotiatedorderdetail-content-list2-div {
      overflow: hidden;
      line-height: 40px;
      font-size: 14px;
      border-bottom: 1px solid #ddd;
      margin: 0 -20px;
      padding: 0 20px;
      color: #797575;
      .content-list2-div-p1 {
        float: left;
        width: 375px;
      }
      .content-list2-div-p2 {
        float: left;
      }
      .content-list2-div-p3 {
        float: right;
      }
    }
    .product {
      .negotiatedorderdetail-content-list3outer {
        .negotiatedorderdetail-content-list10 {
          line-height: 40px;
          .el-row {
            &:last-child {
              margin-bottom: 0;
            }
          }
          .el-col {
            border-radius: 4px;
          }
          .bg-purple-dark {
            background: white;
          }
          .bg-purple {
            background: white;
            .p2-1 {
              color: #4b3f91;
              padding: 5px;
              font-weight: 600;
              font-size: 0.93rem;
              text-align: center;
            }
          }
          .bg-purple-light {
            background: white;
          }
          .grid-content {
            min-height: 36px;
          }
          .negotiatedorderdetail-content-list3-title {
            font-size: 1rem;
            font-weight: 600;
            color: #4b3f91;
            margin: 10px 0;
          }
        }

        .negotiatedorderdetail-content-list3 {
          display: flex;
          flex-direction: row;
          flex-wrap: wrap;
          margin: 0 0 10px 0px;
          cursor: pointer;
          .el-col {
            height: 100%;
          }
          .bg-purple-dark {
            background: white;
          }
          .bg-purple {
            background: white;
            .negotiatedorderdetail-content-list3-left-imgouter {
              border: 1px solid #ddd;
            }
            .negotiatedorderdetail-content-list3-left-img {
              width: 100%;
              height: 100px;
            }

            .negotiatedorderdetail-content-list3-center1 {
              line-height: 43px;
              color: #f08619;
              .negotiatedorderdetail-aftersales {
                line-height: 85px;
                a {
                  color: #f08619;
                }
              }
            }
          }
          .bg-purple {
            background: white;
            .negotiatedorderdetail-content-list3-left-textouter {
              margin-top: 1%;
              .negotiatedorderdetail-content-list3-left-text1 {
                font-size: 1rem;
                font-weight: 500;
              }
              .negotiatedorderdetail-content-list3-left-text2 {
                margin-top: 6%;
                .el-row {
                  margin-bottom: 20px;
                  &:last-child {
                    margin-bottom: 0;
                    padding-bottom: 0px;
                    width: 100%;
                    border-bottom: 0px dashed #ddd;
                  }
                }
                .bg-purple-dark {
                  background: white;
                }
                .bg-purple {
                  background: white;
                }
                .bg-purple-light {
                  .negotiatedorderdetail-content-footer-btn {
                    padding: 0 10px;
                    border: 1px solid #ddd;
                    border-radius: 3px;
                    background: #4b3f91;
                    color: white;
                    border-radius: 5px;
                    background: #4b3f91;
                    color: white;
                  }
                }
                .grid-content {
                  min-height: 36px;
                  .negotiatedorderdetail-listcolor {
                    width: 5px;
                    color: #0086b3;
                  }
                }
                .row-bg {
                  padding: 10px 0;
                  background-color: #f9fafc;
                }
              }
            }
            .negotiatedorderdetail-content-list3-left-textright {
              text-align: center;
              margin-top: 10px;
              font-size: 1rem;
              .textright-p {
                font-weight: 600;
                color: black;
              }
            }
          }
          .grid-content {
            border-radius: 4px;
            min-height: 36px;
          }
          .el-row {
            margin-left: 0 !important;
          }
          .el-col {
            padding-left: 0 !important;
          }
          .el-row {
            padding-bottom: 15px;
            width: 100%;
          }
          .el-row:last-child {
            padding-bottom: 15px;
            width: 100%;
          }
          .negotiatedorderdetail-content-footer {
            line-height: 42px;
            margin: 0px 20px 20px 20px;
            width: 100%;
            overflow: hidden;
            .negotiatedorderdetail-content-footer-textout {
              float: right;
              margin-right: 80px;
              font-size: 0.75rem;
              .negotiatedorderdetail-content-footer-text {
                font-size: 1.125rem;
                margin-left: 10px;
                color: #f08619;
                font-weight: 600;
              }
            }
          }
        }
      }
      .negotiatedorderdetail-params {
        font-size: 1rem;
        .params-items {
          overflow: hidden;
          .items-item {
            float: left;
            width: 25%;
            line-height: 40px;
            border: 1px solid #ddd;
            padding: 0 0 0 20px;
            font-size: 16px;
          }
          .dan {
            background: #f4f4f4;
          }
        }
      }
      .showindex {
        height: 84px;
        overflow: hidden;
      }
    }

    .detail {
      .detail-content {
        margin-top: 20px;
        .detail-content-1 {
          line-height: 40px;
          font-size: 1rem;
          color: #4b3f91;
          font-weight: 600;
        }
        .detail-content-2 {
          display: flex;
          line-height: 30px;
          font-size: 0.93rem;
          .detail-content-2-1 {
            width: 240px;
          }
          .detail-content-2-2 {
            width: 100%;
          }
        }
        .detail-content-3 {
          line-height: 30px;
          font-size: 0.93rem;
        }
        .detail-content-4 {
          display: flex;
          line-height: 30px;
          font-size: 0.93rem;
          .detail-content-4-1 {
            width: 33.34%;
          }
          .detail-content-4-2 {
            width: 33.34%;
          }
          .detail-content-4-3 {
            width: 33.34%;
          }
        }
        .detail-content-5 {
          line-height: 30px;
          font-size: 0.93rem;
          span {
            margin-right: 20px;
          }
          span:last-of-type {
            margin-right: 0;
          }
        }
        .dashed-hr {
          height: 1px;
          margin-top: 20px;
          border: none;
          border-top: 1px dashed #ddd;
        }
        .detail-content-6 {
          border-bottom: 1px solid #ddd;
          padding: 20px 0;
          p:first-of-type {
            color: #f08619;
            font-size: 1rem;
            line-height: 36px;
            font-weight: 400;
          }
          p:last-of-type {
            font-size: 0.875rem;
            span {
              color: #f08619;
              font-size: 1.125rem;
            }
          }
          .btn {
            text-align: right;
            .elbutton {
              background-color: #4b3f91;
              color: white;
            }
          }
        }
      }
    }
    .msg {
      margin: 20px 0;
      line-height: 30px;
      .isme-title {
        font-size: 1rem;
        .title-span {
          float: right;
        }
      }
      .notme-title {
        font-size: 1rem;
        color: #f4a353;
        .title-span {
          float: right;
        }
      }
      .msg-content {
        word-wrap: break-word;
        word-break: break-all;
        overflow: hidden;
        font-size: 0.93rem;
        padding-bottom: 10px;
        border-bottom: 1px dashed #ddd;
      }
      .notme-content {
        color: #f4a353;
      }
    }
    .msgbtn {
      text-align: right;
      margin-top: 20px;
      .msgbtn-input {
        display: inline-block;
        width: 240px;
      }
      .msg-code {
        background: rgb(226, 222, 255);
        color: red;
        display: inline-block;
        width: 80px;
        text-align: center;
        line-height: 35px;
        margin-right: 70px;
        height: 40px;
        font-size: 1.25rem;
      }
      .msg-submit {
        background: #4b3f91;
        color: white;
        width: 140px;
        font-size: 0.875rem;
      }
    }
  }
  .negotiatedorderdetail-Info1 {
    margin-top: 20px;
    border: 1px solid #ddd;
    min-height: 100px;
    padding: 20px;
    .Requirements {
      font-size: 16px;
      color: #4b3f91;
      font-weight: bold;
      line-height: 40px;
    }
    .Requirements-items {
      overflow: hidden;
      line-height: 40px;
      .Requirements-item {
        font-size: 16px;
        float: left;
        width: 50%;
        overflow: hidden;
        padding-right: 20px;
      }
    }
  }
  .negotiatedorderdetail-Info2 {
    margin-top: 20px;
    border: 1px solid #ddd;
    min-height: 100px;
    padding: 20px;
    .Quotation {
      font-size: 16px;
      color: #4b3f91;
      font-weight: bold;
      line-height: 40px;
    }
    .Container {
      overflow: hidden;
      line-height: 40px;
      .Container-item {
        float: left;
        width: 24%;
        font-size: 16px;
      }
      .Container-item:nth-of-type(1) {
        width: 28%;
      }
    }
    .Quotation-items {
      overflow: hidden;
      .Quotation-item {
        font-size: 16px;
        float: left;
        width: 100%;
        overflow: hidden;
        padding-right: 20px;
        .item-title {
          span {
            width: 1px;
            background: #4b3f91;
          }
        }
        .item-content {
          overflow: hidden;
          .item-i {
            float: left;
            width: 7%;
            cursor: pointer;
          }
          .item-text {
            float: left;
            width: 90%;
          }
        }
      }
    }
    .Quotation-ties {
      font-size: 16px;
      line-height: 40px;
    }
  }
  .count-price {
    overflow: hidden;
    line-height: 42px;
    font-size: 16px;
    margin-top: 10px;
    .price-item {
      float: right;
      margin-left: 20px;
      overflow: hidden;
      span {
        // float: left;
        font-weight:bold;
      }
      .item-inpur {
        float: left;
        width: 100px;
        margin-left: 10px;
      }
    }
  }
  .ok-btn {
    margin: 10px 0 0 0;
    line-height: 40px;
    overflow: hidden;
    .agreeBtn {
      width: 190px;
      background: #4b3f91;
      color: white;
      border-radius: 5px;
      float: right;
      font-size: 16px;
      text-align: center;
      cursor: pointer;
      margin-right: 40px;
    }
    .agreeBtn1{
      width: 230px;
      background: #4b3f91;
      color: white;
      border-radius: 5px;
      float: right;
      font-size: 16px;
      text-align: center;
      cursor: pointer;
    }
  }
}
</style>

<template>
  <section class="container">
    <div class="negotiatedorderdetail">
      <div class="negotiatedorderdetail-title">
        <p>My Order</p>
      </div>
      <div class="negotiatedorderdetail-content">
        <div class="negotiatedorderdetail-content-list2">
          <p class="negotiatedorderdetail-content-list2-p">
            <img src="../../assets/img/allordertitle_03.jpg" height="20" width="28">
            Negotiated order
          </p>
        </div>
        <p
          class="negotiatedorderdetail-content-list2-p2"
        >(You can modify the planned purchase queantity and tell us the expected purchase price.We will reply you within 24 hours)</p>
        <div class="negotiatedorderdetail-content-list2-div">
          <p class="content-list2-div-p1">Quotation：{{orderlist.sn}}</p>
          <p class="content-list2-div-p2">Date：{{showDate}}</p>
          <p class="content-list2-div-p3">Quotation Validity：15day</p>
        </div>
        <div class="product" v-for="(items,index,key) in goods_list" :key="key">
          <div class="negotiatedorderdetail-content-list3outer">
            <div class="negotiatedorderdetail-content-list10">
              <el-row>
                <el-col :xs="12" :sm="12" :md="12" :lg="12" :xl="12">
                  <div class="grid-content bg-purple">
                    <div class="negotiatedorderdetail-content-list3-title">
                      <p>Order ID :{{orderlist.sn}}</p>
                    </div>
                  </div>
                </el-col>
                <el-col :xs="4" :sm="4" :md="4" :lg="4" :xl="4">
                  <div class="grid-content bg-purple">
                    <div class>
                      <p class="p2-1">Quantity</p>
                    </div>
                  </div>
                </el-col>
                <el-col :xs="4" :sm="4" :md="4" :lg="4" :xl="4">
                  <div class="grid-content bg-purple">
                    <div class>
                      <p class="p2-1">Unit Price</p>
                    </div>
                  </div>
                </el-col>
                <el-col :xs="4" :sm="4" :md="4" :lg="4" :xl="4">
                  <div class="grid-content bg-purple">
                    <div class>
                      <p class="p2-1">Subtotal</p>
                    </div>
                  </div>
                </el-col>
              </el-row>
            </div>
            <div class="negotiatedorderdetail-content-list3">
              <el-row :gutter="20">
                <el-col :xs="3" :sm="3" :md="3" :lg="3" :xl="3">
                  <div class="grid-content bg-purple">
                    <div class="negotiatedorderdetail-content-list3-left-imgouter">
                      <img
                        class="negotiatedorderdetail-content-list3-left-img"
                        :src="items.img_url | imgCompress(80,100)"
                      >
                    </div>
                  </div>
                </el-col>
                <el-col :xs="9" :sm="9" :md="9" :lg="9" :xl="9">
                  <div class="grid-content bg-purple">
                    <div class="negotiatedorderdetail-content-list3-left-textouter">
                      <nuxt-link :to="{name: 'product-id',params:{id:items.goods_id}}" target="_blank">
                            <p class="negotiatedorderdetail-content-list3-left-text1">{{items.title}}
                            </p>
                      </nuxt-link>
                    </div>
                  </div>
                </el-col>
                <el-col :xs="4" :sm="4" :md="4" :lg="4" :xl="4">
                  <div class="grid-content bg-purple">
                    <div class="negotiatedorderdetail-content-list3-left-textright">
                      <p class="textright-p" v-if="items.num">{{items.num}}</p>
                    </div>
                  </div>
                </el-col>
                <el-col :xs="4" :sm="4" :md="4" :lg="4" :xl="4">
                  <div class="grid-content bg-purple">
                    <div class="negotiatedorderdetail-content-list3-left-textright">
                      <!-- <p class="textright-p" >EXW ＄{{items.exw_price}}</p> -->
                      <p class="textright-p"  v-if="orderlist.status === 'wait_confirm_offer'">＄{{items.fob_price|money}}</p>
                      <p class="textright-p"  v-if="orderlist.status !== 'wait_confirm_offer'">Waiting for quote</p>
                    </div>
                  </div>
                </el-col>
                <el-col :xs="4" :sm="4" :md="4" :lg="4" :xl="4">
                  <div class="grid-content bg-purple">
                    <div class="negotiatedorderdetail-content-list3-left-textright">
                      <!-- <p class="textright-p" >EXW ＄{{items.num * Number(items.exw_price)}}</p> -->
                      <p class="textright-p" v-if="orderlist.status === 'wait_confirm_offer'">＄{{(items.num * Number(items.fob_price))|money}}</p>
                      <p class="textright-p"  v-if="orderlist.status !== 'wait_confirm_offer'">--</p>
                    </div>
                  </div>
                </el-col>
              </el-row>
            </div>
          </div>
          <div
            class="negotiatedorderdetail-params"
            v-show="items.param!==null||items.param!==''||items.param!==undefined"
          >
            <div class="params-items" :class="{'showindex':items.showindex === 1}">
              <div
                class="items-item"
                v-for="(itemss,index,key) in items.param"
                :key="key"
                :class="{'dan':index===0||(index%2) === 0}"
              >&nbsp;{{itemss.title}}：{{itemss.custom_value}}</div>
              <!--<div class="items-item" v-for="(itemss,index,key) in items.param" v-if="(key%2)!==0" :key="key" >&nbsp;{{itemss.title}}：{{itemss.custom_value}}</div>-->
              <!--<div class="items-item">&nbsp;功率：300W</div>
              <div class="items-item dan">&nbsp;标准：CE</div>
              <div class="items-item">&nbsp;功率：300W</div>
              <div class="items-item dan">&nbsp;尺寸：4"</div>
              <div class="items-item">&nbsp;电机类型：全铜线电机</div>
              <div class="items-item dan">&nbsp;颜色：红</div>
              <div class="items-item">&nbsp;控制类型：机器式</div>
              <div class="items-item dan">&nbsp;插头类型：1</div>
              <div class="items-item">&nbsp;底盘类型：1</div>
              <div class="items-item dan">&nbsp;外壳材质：金属外壳</div>
              <div class="items-item">&nbsp;扇叶材质：金属</div>
              <div class="items-item dan">&nbsp;网罩材质：金属</div>
              <div class="items-item">&nbsp;表面效果：原色</div>
              <div class="items-item dan">&nbsp;档位：三挡</div>
              <div class="items-item">&nbsp;定时器：60分钟</div>
              <div class="items-item dan">&nbsp;广角摇头：90°</div>
              <div class="items-item">&nbsp;</div>
              <div class="items-item dan">&nbsp;</div>
              <div class="items-item">&nbsp;</div>-->
            </div>
            <div
              style="    text-align: center;
    line-height: 60px;
    border-bottom: 1px solid #ddd;
    margin: 0 -20px;cursor: pointer"
              @click="fold(index)"
            >
              <img
                v-show="items.showindex === 2"
                src="../../assets/img/up.png"
                height="13"
                width="10"
              >
              <img
                v-show="items.showindex === 1"
                src="../../assets/img/down.png"
                height="13"
                width="10"
              >
              <span
                style="font-size: 14px;margin-left: 10px;color: #a09f9f;"
                v-show="items.showindex === 2"
              >Fold</span>
              <span
                style="font-size: 14px;margin-left: 10px;color: #a09f9f;"
                v-show="items.showindex === 1">
              Unfold</span>
            </div>
          </div>
        </div>
      </div>
      <div class="negotiatedorderdetail-Info1">
        <div class="Requirements">Other Requirements</div>
        <div class="Requirements-items">
          <p
            class="Requirements-item"
          >Destination Port/ Country：{{port_info.en_name}}/{{port_info.country_en_name}}</p>
          <p
            class="Requirements-item"
            v-if="Number(orderlist.sample_requirements) === 0"
          >Sample Requirements：NO</p>
          <p
            class="Requirements-item"
            v-if="Number(orderlist.sample_requirements) !== 0"
          >Sample Requirements：Yes</p>
          <p
            class="Requirements-item"
            v-if="Number(orderlist.factory_inspection) !== 0"
          >Factory Inspection：Filed Survey</p>
          <p
            class="Requirements-item"
            v-if="Number(orderlist.factory_inspection) === 0"
          >Factory Inspection：online_inspection</p>
          <p
            class="Requirements-item"
            v-if="Number(orderlist.factory_inspection) === 1"
          >Schedule Date for Factory Inspection：{{comment.formate('yyyy-MM-dd',new Date(orderlist.online_inspection_date))}}</p>
          <p
            class="Requirements-item"
            v-if="Number(orderlist.final_payment_type) === 0"
          >Final Payment：After Loading</p>
          <p
            class="Requirements-item"
            v-if="Number(orderlist.final_payment_type) === 1"
          >Final Payment：Before Loading</p>
          <p
            class="Requirements-item"
          >Delivery within {{orderlist.shipment_date}} days after Receipt of Deposit</p>
          <p
            class="Requirements-item"
          >Payment Terms：Deposit {{orderlist.down_payment}}%, Final Payment {{orderlist.final_payment}}%</p>
        </div>
      </div>
      <div class="negotiatedorderdetail-Info2" v-if="orderlist.status === 'wait_confirm_offer'">
        <div class="Quotation">Quotation Details</div>
        <div class="Container">
          <div class="Container-item">Container Quantities：</div>
          <div class="Container-item">20GP：{{orderlist.gp20_num}}</div>
          <div class="Container-item">40GP：{{orderlist.gp40_num}}</div>
          <div class="Container-item">40HQ：{{orderlist.hq40_num}}</div>
        </div>
        <div class="Quotation-items">
          <div class="Quotation-item">
            <p class="item-title">
              <span>&nbsp;</span>&nbsp;Price:
            </p>
            <div class="item-content">
              <div class="item-text">
                <p>
                  If you choose FOB， we will transport your goods
                  to the port mentioned as below，and finish the
                  customs clearance.
                </p>
                <p>Wharf：{{port_pol_info.en_name}}/{{port_pol_info.country_en_name}}</p>
              </div>
            </div>
          </div>
        </div>
        <div class="Quotation-ties">
          <p>
            <span style="color: red">*</span>You can specify the port，which may affect the FOB price. Please leave a message to us to renew the quotation.
          </p>
        </div>
      </div>

      <div class="count-price" v-if="orderlist.status === 'wait_confirm_offer'">
        <div class="price-item">
          <!-- <span>Final Payment:{{finalpament | numFilter(2)}}</span> -->
          Final Payment: <span>{{finalpament | numFilter(2)}}</span>
          <!-- <el-input class="item-inpur" disabled v-model="finalpament"></el-input> -->
        </div>
        <div class="price-item">
          Deposit: <span>{{deposit | numFilter(2)}}</span>
        </div>
        <div class="price-item" >
          Price: <span>{{fobcount | numFilter(2)}}</span>
          <!-- <el-input class="item-inpur" disabled v-model="fobcount"></el-input> -->
        </div>
      </div>
      <div class="count-price" v-if="orderlist.status !== 'wait_confirm_offer'">
        <div class="price-item">
         Waiting for quote
        </div>
      </div>
      <div v-if="orderlist.status === 'wait_confirm_offer'" class="ok-btn" >
        
        <div class="agreeBtn1" @click="disagreePice">Please adjust the quotation</div>
        <div class="agreeBtn" @click="agreePice">I agree to the price</div>
      </div>
    </div>
  </section>
</template>

<script>
import changeuserInfobar from "../../components/ordercommon/changeuserInfobar.vue";
import {imgCompress} from '~/plugins/filters.js';
export default {
  components: {
    changeuserInfobar: changeuserInfobar
  },
  name: "negotiatedorderdetail",
  data() {
    return {
      textarea: "",
      input5: "",
      tempid: this.$route.query.id,
      orderlist: {},
      goods_list: [],
      templength: 0,
      talkmsg: [],
      port_info: {},
      port_pol_info:{},
      token: "",
      show1: false,
      fobcount: "$",
      tempfobcount: 0,
      tempexwcount: 0,
      exwcount: "$  ",
      deposit: "$  ",
      finalpament: "$  ",
      //       "down_payment" 首付百分比
      //        "final_payment"  尾款百分比
      showDate: ""
    };
  },
  methods: {
    fold(index) {
      if (this.goods_list[index].showindex === 1) {
        this.goods_list[index].showindex = 2;
        this.goods_list.splice(index, 1, this.goods_list[index]);
      } else {
        this.goods_list[index].showindex = 1;
        this.goods_list.splice(index, 1, this.goods_list[index]);
      }
    },
    back() {
      this.$router.push("/one");
    },
    submitorder() {
      this.$router.push("/member/pending/submitpendingorder");
    },
    getitemdata() {
      let that = this;
      let itemUrl = that.$store.state.headerUrl + "member/order/" + that.tempid;
      let tempalert = that.$alert;
      that.comment
        .axiosGet(itemUrl, that.$axios, that.$store)
        .then(function(resp) {
          if (resp.data.code === 0) {
            that.orderlist = resp.data.data;
            that.goods_list = resp.data.data.goods_list;
            that.port_info = resp.data.data.port_info;
            that.port_pol_info = resp.data.data.port_pol_info;
            that.showDate = that.comment.formate(
              "yyyy-MM-dd hh:mm:ss",
              new Date(Number(that.orderlist.create_time) * 1000)
            );
            that.tempfobcount = 0;
            that.tempexwcount = 0;
            for (let i = 0; i < that.goods_list.length; i++) {
              that.goods_list[i].showindex = 1;
              // console.log(Number(that.goods_list[i].fob_price))
              // console.log(Number(that.goods_list[i].num))
              // console.log(Number(that.goods_list[i].fob_price) * Number(that.goods_list[i].num))
              // console.log(that.tempfobcount + Number(that.goods_list[i].fob_price) * Number(that.goods_list[i].num))
              that.tempfobcount = that.tempfobcount + Number(that.goods_list[i].fob_price) * Number(that.goods_list[i].num);
              that.tempexwcount = that.tempexwcount + Number(that.goods_list[i].exw_price) * Number(that.goods_list[i].num);
            }
            that.fobcount = that.fobcount + that.tempfobcount;
            that.exwcount = that.exwcount + that.tempexwcount;
            that.deposit =
              "$" +
              (that.tempfobcount * Number(that.orderlist.down_payment)) / 100;
            that.finalpament =
              "$" +
              (that.tempfobcount * Number(that.orderlist.final_payment)) / 100;

            that.templength = that.orderlist.goods_list.length;
          } else {
            tempalert(resp.data.msg, {
              confirmButtonText: "ok",
              center: true
            });
          }
        })
        .catch(function(error) {
          tempalert(error, {
            confirmButtonText: "ok",
            center: true
          });
        });
    },
    sendmsg() {
      let that = this;
      let sendUrl = that.$store.state.headerUrl + "/member/order/comment";
      let tempalert = that.$alert;
      let data = {
        order_id: Number(that.tempid),
        content: that.textarea
      };
      if (data.content === "") {
        tempalert("The input cannot be empty", {
          confirmButtonText: "ok",
          center: true
        });
      } else {
        that.comment
          .axiosPost(sendUrl, that.$axios, that.$store, data, tempalert)
          .then(function(resp) {
            if (resp.data.code === 0) {
              tempalert(resp.data.msg, {
                confirmButtonText: "ok",
                center: true,
                callback: action => {
                  that.textarea = "";
                  that.getmsg();
                }
              });
            } else {
              tempalert(resp.data.msg, {
                confirmButtonText: "ok",
                center: true,
                callback: action => {
                  that.textarea = "";
                }
              });
            }
          })
          .catch(function(error) {
            tempalert(error, {
              confirmButtonText: "ok",
              center: true,
              callback: action => {
                that.textarea = "";
              }
            });
          });
      }
    },
    agreePice() {
      var that = this;
      let agressUrl = that.$store.state.headerUrl + "/member/order/agree_price";
      let tempalert = that.$alert;
      let temptype = "FOB";
      let params = {
        id: Number(that.tempid),
        custom_choose_price_type: temptype
      };
      that.comment
        .axiosPost(agressUrl, that.$axios, that.$store, params, tempalert)
        .then(function(resp) {
          if (resp.data.code === 0) {
            tempalert(resp.data.msg, {
              confirmButtonText: "ok",
              center: true,
              callback: action => {
                that.$router.push({
                  path: "/member/wait/waitingforpaymentorderdetail",
                  query: { id: that.tempid, token: that.token }
                });
                //                that.$router.push({path:'/member/membercentre',query:{page:1}})
              }
            });
          } else {
            tempalert(resp.data.msg, {
              confirmButtonText: "ok",
              center: true
            });
          }
        })
        .catch(function(error) {
          tempalert(error, {
            confirmButtonText: "ok",
            center: true
          });
        });
    },
    //不同意报价
    disagreePice(){
       let that = this;
       let url = that.$store.state.headerUrl + "member/order/disagree_price";
       let params = {
         id:Number(that.tempid)
       }
       let tempalert = that.$alert;
       that.comment.axiosPost(url,that.$axios,that.$store,params,tempalert).then((resp) => {
         if(resp.data.code === 0){
            tempalert(resp.data.msg, {
              confirmButtonText: "ok",
              center: true,
              callback: action => {
                that.$router.push({
                  path: "/member/negotiatedorder",
                  query: { page: 1 }
                });
              }
            });
         }else{
           tempalert(resp.data.msg, {
              confirmButtonText: "ok",
              center: true
            });
         }

       }).catch((error) => {

       })
    }
  },
  mounted() {
if(localStorage.getItem("users")){
      this.getitemdata();
      this.users = this.$store.state.users;
      this.token = JSON.parse(localStorage.getItem('users')).token;
    }
  },
  watch: {
    //监听路由变化，刷新页面
    $route(to, from) {
      this.$router.go(0);
    },
    finalpament: function(val) {
      if (val === "") {
        this.finalpament = "$";
      }
    },
    deposit: function(val) {
      if (val === "") {
        this.deposit = "$";
      }
    },
    fobcount: function(val) {
      if (val === "") {
        this.fobcount = "$";
      }
    }
  }
};
</script>

